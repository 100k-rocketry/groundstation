<html>
<head>
    <meta charset=utf-8>
</head>
<body>
    <canvas id="canvas" width="100%" height="100%"></canvas>
</body>
<script language = "javascript" src = "scripts/three/build/three.min.js"></script>
<script language = "javascript" src = "scripts/three/examples/js/controls/TrackballControls.js"></script>
<script language = "javascript" src = "scripts/three/examples/js/loaders/OBJLoader.js"></script>
<script>


var exampleSocket = new WebSocket("ws://" + window.location.host);



    var scene = new THREE.Scene();
    //scene.background = new THREE.Color(0x84C5F0);
    var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

    var renderer = new THREE.WebGLRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );
    document.body.appendChild( renderer.domElement );

    //var geometry = new THREE.BoxGeometry( 1, 1, 1 );
    //var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
    //var cube = new THREE.Mesh( geometry, material );
    //scene.add( cube );


    var rocketGeometry = new THREE.SphereGeometry(.1, 32, 32);
    var rocketMaterial = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
    var rocket = new THREE.Mesh( rocketGeometry, rocketMaterial );

		rocket.position.set(0, 1.4, 0);

    scene.add(rocket);

    camera.position.z = 5;

    function render() {
    	requestAnimationFrame( render );
      //rocket.translateY(0.001);
    	renderer.render( scene, camera );
    }

	function animate() {
		requestAnimationFrame( animate );
		controls.update();
	}

    controls = new THREE.TrackballControls( camera );
    controls.target.set( 0, 0, 0 );

	controls.rotateSpeed = 10.0;
	controls.zoomSpeed = 1.2;
	controls.panSpeed = 0.8;

	controls.noZoom = false;
	controls.noPan = false;

	controls.staticMoving = true;
	controls.dynamicDampingFactor = 0.3;

    controls.addEventListener('change', render);


THREE.ImageUtils.crossOrigin = "";

    var loader = new THREE.TextureLoader();

<<<<<<< HEAD

				var ambientLight = new THREE.AmbientLight ( 0xffffff , .5);

				scene.add ( ambientLight );

				var directionalLight = new THREE.DirectionalLight( 0xffeedd, 1 );
				directionalLight.position.set( 0, 0, 7 );
				scene.add( directionalLight );
        /*var shaderMaterial = new THREE.ShaderMaterial({
        uniforms: uniforms,
        vertexShader: phongShader.vertexShader,
        fragmentShader: phongShader.fragmentShader,
        lights:true,
        fog: true
      });*/


=======

				var ambientLight = new THREE.AmbientLight ( 0xffffff , .1);
				scene.add ( ambientLight );

				var directionalLight = new THREE.DirectionalLight( 0x0000ee , 1.0);
				directionalLight.position.set( 10, 1.3, 0 );
				scene.add( directionalLight );

>>>>>>> 15a2a43f57af95e66b3fd277e6b6f63672e1ab85
					var manager = new THREE.LoadingManager();
				manager.onProgress = function ( item, loaded, total ) {

					console.log( item, loaded, total );

				};


	var onProgress = function ( xhr ) {
					if ( xhr.lengthComputable ) {
						var percentComplete = xhr.loaded / xhr.total * 100;
						console.log( Math.round(percentComplete, 2) + '% downloaded' );
					}
				};

	var onError = function ( xhr ) {
	};

					//var texture = new THREE.Texture();

	var loader = new THREE.OBJLoader( manager );
  //Loading object here
				loader.load( 'usub2.obj', function ( object ) {

					object.traverse( function ( child ) {

						if ( child instanceof THREE.Mesh ) {

							//child.material.map = texture;

						}

					} );

					object.position.y = 0;
					object.position.x = 0;
					object.position.z = 0;
					scene.add( object );

					render();

				}, onProgress, onError );



    animate();
    render();


exampleSocket.onmessage = function(event) {
	// Use JSON.parse(event.data) to turn back into an object
	console.log(event.data);
	packet = JSON.parse(event.data);

	/*document.getElementById("telemetry").innerHTML +=
			"<b>Altimeter:</b> " + packet.altimeter + "<br>" +
			"<b>Latitude:</b> " + packet.latitude + "<br>" +
			"<b>Timestamp:</b>" + packet.timestamp + "<br><br>";

		}*/
		/*document.getElementById("telemetryrocket").innerHTML+= '<tr><td>' +packet.altimeter +' </td><td>'
		 +packet.latitude +' </td><td>' +packet.longitude +'</td><td>'
		 +packet.accelerometer_x +'</td><td>'+packet.accelerometer_y +'</td><td>'
		 +packet.accelerometer_z +'</td><td>'+packet.yaw +'</td><td>'
		 +packet.pitch +'</td><td>'+packet.roll +'</td><td>'
		 +packet.timestamp +'</td></tr>';
		*/

		var x = packet.longitude - (-106.97305) * 92;
		var y = packet.latitude - (32.9893) * 111;
		var z = packet.altitude / 1000;

		rocket.position.set(x, y, z);)

}



</script>
</html>
